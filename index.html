<!doctype html>
<html lang="es">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Directorio de Negocios - Mi Ciudad</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        
        /* Colores personalizados */
        :root {
            --primary-orange: #db3717;
            --primary-dark: #151a2b;
        }
        
        /* Responsive design autom√°tico */
        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 0 16px;
        }
        
        @media (min-width: 640px) {
            .container { max-width: 640px; }
        }
        
        @media (min-width: 768px) {
            .container { max-width: 768px; }
        }
        
        @media (min-width: 1024px) {
            .container { max-width: 1024px; }
        }
        
        /* Franja naranja superior */
        .orange-stripe {
            background: linear-gradient(135deg, #db3717 0%, #ff6b47 100%);
            height: 8px;
            width: 100%;
        }
        
        /* Estilos para categor√≠as */
        .category-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .category-card:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(219, 55, 23, 0.2);
        }
        
        /* Estilos para tarjetas de negocios */
        .business-card {
            transition: all 0.3s ease;
            border-left: 4px solid var(--primary-orange);
        }
        
        .business-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        
        /* Botones personalizados */
        .btn-primary {
            background-color: var(--primary-orange);
            color: white;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background-color: #c12e14;
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background-color: var(--primary-dark);
            color: white;
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            background-color: #0f1419;
            transform: translateY(-1px);
        }
        
        /* Modal styles */
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }
        
        /* Loading spinner */
        .loading-spinner {
            border: 2px solid #f3f4f6;
            border-top: 2px solid var(--primary-orange);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Toast notifications */
        .toast {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            padding: 12px 24px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .toast.show {
            opacity: 1;
        }
        
        .toast.success {
            background-color: #10b981;
        }
        
        .toast.error {
            background-color: #ef4444;
        }
        
        .toast.info {
            background-color: #3b82f6;
        }
        
        /* Responsive grid */
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 12px;
        }
        
        @media (max-width: 480px) {
            .categories-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        /* Safe areas para dispositivos m√≥viles */
        .safe-area-top {
            padding-top: env(safe-area-inset-top);
        }
        
        .safe-area-bottom {
            padding-bottom: env(safe-area-inset-bottom);
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
 </head>
 <body class="bg-gray-50 min-h-screen"><!-- Franja Naranja Superior -->
  <div class="orange-stripe safe-area-top"></div><!-- Header con Logo -->
  <header class="bg-white shadow-lg">
   <div class="container py-4">
    <div class="flex items-center justify-center">
     <div class="flex items-center space-x-3"><img src="./images/logo-empresa.png" alt="Logo Empresa" class="w-12 h-12 rounded-full object-cover" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
      <div class="w-12 h-12 rounded-full flex items-center justify-center text-white text-xl font-bold" style="background-color: var(--primary-orange); display: none;">
       üè¢
      </div>
      <div class="text-center">
       <h1 class="text-xl font-bold" style="color: var(--primary-dark);">Mi Empresa</h1>
       <p class="text-sm text-gray-600">Directorio de Negocios</p>
      </div>
     </div>
    </div>
   </div>
  </header><!-- Barra de Men√∫ con B√∫squeda -->
  <nav class="bg-white border-b border-gray-200">
   <div class="container py-3">
    <div class="flex flex-col space-y-3 sm:flex-row sm:space-y-0 sm:space-x-3 sm:items-center"><!-- Barra de b√∫squeda -->
     <div class="flex-1 relative"><input type="text" id="search-input" placeholder="üîç Buscar negocios..." class="w-full px-4 py-2 border-2 rounded-lg focus:outline-none focus:ring-2 text-sm" style="border-color: var(--primary-orange); --tw-ring-color: var(--primary-orange);"> <button id="search-btn" class="absolute right-2 top-1/2 transform -translate-y-1/2 btn-primary px-3 py-1 rounded text-sm"> Buscar </button>
     </div><!-- Botones de informaci√≥n -->
     <div class="flex space-x-2"><button id="about-btn" class="btn-secondary px-4 py-2 rounded-lg text-sm font-medium"> üë• Qui√©nes Somos </button> <button id="services-btn" class="btn-primary px-4 py-2 rounded-lg text-sm font-medium"> üõ†Ô∏è Servicios </button>
     </div>
    </div>
   </div>
  </nav><!-- Contenido Principal -->
  <main class="container py-6"><!-- Secci√≥n de Categor√≠as -->
   <section class="mb-8">
    <h2 class="text-2xl font-bold mb-4" style="color: var(--primary-dark);">Categor√≠as de Negocios</h2>
    <div class="categories-grid" id="categories-container"><!-- Las categor√≠as se generar√°n din√°micamente -->
    </div>
   </section><!-- Filtros Activos -->
   <section id="active-filters" class="mb-6 hidden">
    <div class="flex flex-wrap items-center gap-2"><span class="text-sm font-medium text-gray-600">Filtros activos:</span>
     <div id="filter-tags" class="flex flex-wrap gap-2"></div><button id="clear-filters" class="text-sm px-3 py-1 rounded-full border hover:bg-gray-50" style="border-color: var(--primary-orange); color: var(--primary-orange);"> ‚úï Limpiar </button>
    </div>
   </section><!-- Contador y Bot√≥n Agregar -->
   <section class="mb-6">
    <div class="flex justify-between items-center">
     <p id="business-count" class="text-lg font-medium" style="color: var(--primary-dark);">Cargando negocios...</p><button id="add-business-btn" class="btn-primary px-4 py-2 rounded-lg font-medium"> ‚ûï Publicar Negocio </button>
    </div>
   </section><!-- Lista de Negocios -->
   <section id="business-list" class="space-y-4"><!-- Los negocios se mostrar√°n aqu√≠ -->
   </section><!-- Estado Vac√≠o -->
   <section id="empty-state" class="text-center py-12 hidden">
    <div class="text-6xl mb-4">
     üè™
    </div>
    <h3 class="text-2xl font-bold mb-3" style="color: var(--primary-dark);">¬°S√© el primero!</h3>
    <p class="text-gray-600 mb-6">No hay negocios publicados a√∫n. Publica el tuyo y comienza a crecer.</p><button id="empty-add-btn" class="btn-primary px-6 py-3 rounded-lg font-medium"> ‚ûï Publicar Primer Negocio </button>
   </section><!-- Sin Resultados -->
   <section id="no-results" class="text-center py-12 hidden">
    <div class="text-6xl mb-4">
     üîç
    </div>
    <h3 class="text-2xl font-bold mb-3" style="color: var(--primary-dark);">Sin resultados</h3>
    <p class="text-gray-600">No encontramos negocios que coincidan con tu b√∫squeda.</p>
   </section>
  </main><!-- Modal para Publicar Negocio -->
  <div id="add-business-modal" class="fixed inset-0 modal-backdrop hidden items-center justify-center z-50 p-4">
   <div class="bg-white rounded-2xl shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto">
    <div class="p-6">
     <div class="flex justify-between items-center mb-6">
      <h2 class="text-xl font-bold" style="color: var(--primary-dark);">üìù Publicar Negocio</h2><button id="close-modal" class="text-gray-500 hover:text-gray-700 text-2xl">‚úï</button>
     </div>
     <form id="business-form">
      <div class="space-y-4">
       <div><label for="business-name" class="block text-sm font-medium mb-2" style="color: var(--primary-dark);"> Nombre del Negocio * </label> <input type="text" id="business-name" required class="w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--primary-orange); --tw-ring-color: var(--primary-orange);" placeholder="Ej: Restaurante El Buen Sabor">
       </div>
       <div><label for="business-category" class="block text-sm font-medium mb-2" style="color: var(--primary-dark);"> Categor√≠a * </label> <select id="business-category" required class="w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--primary-orange); --tw-ring-color: var(--primary-orange);"> <option value="">Seleccionar categor√≠a</option> </select>
       </div>
       <div><label for="business-description" class="block text-sm font-medium mb-2" style="color: var(--primary-dark);"> Descripci√≥n </label> <textarea id="business-description" rows="4" class="w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--primary-orange); --tw-ring-color: var(--primary-orange);" placeholder="Describe tu negocio..."></textarea>
       </div>
       <div><label for="business-phone" class="block text-sm font-medium mb-2" style="color: var(--primary-dark);"> Tel√©fono </label> <input type="tel" id="business-phone" class="w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--primary-orange); --tw-ring-color: var(--primary-orange);" placeholder="Ej: +1234567890">
       </div>
       <div><label for="business-address" class="block text-sm font-medium mb-2" style="color: var(--primary-dark);"> Direcci√≥n </label> <input type="text" id="business-address" class="w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--primary-orange); --tw-ring-color: var(--primary-orange);" placeholder="Ej: Calle Principal 123">
       </div>
       <div><label for="business-website" class="block text-sm font-medium mb-2" style="color: var(--primary-dark);"> Sitio Web </label> <input type="url" id="business-website" class="w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--primary-orange); --tw-ring-color: var(--primary-orange);" placeholder="https://www.minegocio.com">
       </div>
       <div><label for="business-image" class="block text-sm font-medium mb-2" style="color: var(--primary-dark);"> Imagen del Negocio </label> <input type="text" id="business-image" class="w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--primary-orange); --tw-ring-color: var(--primary-orange);" placeholder="nombre-imagen.jpg (debe estar en carpeta images/)">
        <p class="text-xs text-gray-500 mt-1">üí° Coloca la imagen en la carpeta images/ del proyecto</p>
       </div>
      </div>
      <div class="flex gap-4 mt-8"><button type="button" id="cancel-btn" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-3 px-4 rounded-lg font-medium transition-colors"> Cancelar </button> <button type="submit" id="submit-btn" class="flex-1 btn-primary py-3 px-4 rounded-lg font-medium"> Publicar Negocio </button>
      </div>
     </form>
    </div>
   </div>
  </div><!-- Modal de Informaci√≥n -->
  <div id="info-modal" class="fixed inset-0 modal-backdrop hidden items-center justify-center z-50 p-4">
   <div class="bg-white rounded-2xl shadow-xl w-full max-w-md max-h-[80vh] overflow-y-auto">
    <div class="p-6">
     <div class="flex justify-between items-center mb-4">
      <h2 id="info-modal-title" class="text-xl font-bold" style="color: var(--primary-dark);"></h2><button id="close-info-modal" class="text-gray-500 hover:text-gray-700 text-2xl">‚úï</button>
     </div>
     <div id="info-modal-content" class="text-gray-600"><!-- Contenido din√°mico -->
     </div>
    </div>
   </div>
  </div><!-- Footer -->
  <footer class="mt-12 py-8 text-center" style="background-color: var(--primary-dark);">
   <div class="container">
    <p class="text-white text-sm">¬© 2024 Mi Empresa - Directorio de Negocios</p>
    <p class="text-gray-400 text-xs mt-2">Conectando negocios con la comunidad</p>
   </div>
  </footer>
  <script>
        // Sistema de almacenamiento permanente usando localStorage
        class DataLocalStorage {
            constructor() {
                this.storageKey = 'business_directory_data';
                this.businesses = [];
                this.loadData();
            }
            
            async loadData() {
                try {
                    // Cargar datos desde localStorage del navegador
                    const savedData = localStorage.getItem(this.storageKey);
                    if (savedData) {
                        this.businesses = JSON.parse(savedData);
                        console.log(`‚úÖ Cargados ${this.businesses.length} negocios desde localStorage`);
                    } else {
                        // Si no hay datos, crear algunos de ejemplo para demostraci√≥n
                        this.businesses = this.getInitialData();
                        await this.saveData();
                        console.log('üìù Datos iniciales creados');
                    }
                    this.notifyDataChange();
                } catch (error) {
                    console.error('Error cargando datos:', error);
                    this.businesses = this.getInitialData();
                    this.notifyDataChange();
                }
            }
            
            async saveData() {
                try {
                    // Guardar datos en localStorage del navegador (permanente)
                    localStorage.setItem(this.storageKey, JSON.stringify(this.businesses));
                    console.log(`üíæ Guardados ${this.businesses.length} negocios en localStorage`);
                    return true;
                } catch (error) {
                    console.error('Error guardando datos:', error);
                    return false;
                }
            }
            
            // Datos iniciales de ejemplo (solo se crean la primera vez)
            getInitialData() {
                return [
                    {
                        id: "demo_1",
                        name: "Restaurante El Buen Sabor",
                        category: "Restaurantes",
                        description: "Comida casera y tradicional con los mejores ingredientes frescos de la regi√≥n",
                        phone: "+1234567890",
                        address: "Calle Principal 123, Centro",
                        website: "https://www.elbuensabor.com",
                        image: "restaurante-demo.jpg",
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: "demo_2",
                        name: "Hotel Plaza Central",
                        category: "Hoteles",
                        description: "Hotel boutique en el coraz√≥n de la ciudad con todas las comodidades modernas",
                        phone: "+1234567891",
                        address: "Plaza Central 45, Zona Tur√≠stica",
                        website: "",
                        image: "",
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: "demo_3",
                        name: "Helader√≠a Dulce Tentaci√≥n",
                        category: "Helader√≠as",
                        description: "Los helados artesanales m√°s deliciosos de la ciudad con sabores √∫nicos",
                        phone: "+1234567892",
                        address: "Avenida Libertad 78",
                        website: "",
                        image: "",
                        createdAt: new Date().toISOString()
                    }
                ];
            }
            
            async addBusiness(business) {
                business.id = this.generateId();
                business.createdAt = new Date().toISOString();
                this.businesses.unshift(business);
                await this.saveData();
                this.notifyDataChange();
                return business.id;
            }
            
            async updateBusiness(id, updates) {
                const index = this.businesses.findIndex(b => b.id === id);
                if (index !== -1) {
                    this.businesses[index] = { ...this.businesses[index], ...updates };
                    await this.saveData();
                    this.notifyDataChange();
                    return true;
                }
                return false;
            }
            
            async deleteBusiness(id) {
                const index = this.businesses.findIndex(b => b.id === id);
                if (index !== -1) {
                    this.businesses.splice(index, 1);
                    await this.saveData();
                    this.notifyDataChange();
                    return true;
                }
                return false;
            }
            
            getBusinesses() {
                return [...this.businesses];
            }
            
            generateId() {
                return Date.now().toString() + Math.random().toString(36).substr(2, 9);
            }
            
            notifyDataChange() {
                // Notificar a la aplicaci√≥n que los datos han cambiado
                if (window.app && window.app.onDataChange) {
                    window.app.onDataChange(this.businesses);
                }
            }
        }
        
        // Categor√≠as de negocios
        const categories = [
            { name: "Hoteles", icon: "üè®", color: "#db3717" },
            { name: "Restaurantes", icon: "üçΩÔ∏è", color: "#151a2b" },
            { name: "Helader√≠as", icon: "üç¶", color: "#db3717" },
            { name: "Tiendas", icon: "üõçÔ∏è", color: "#151a2b" },
            { name: "Servicios", icon: "üîß", color: "#db3717" },
            { name: "Salud", icon: "üè•", color: "#151a2b" },
            { name: "Educaci√≥n", icon: "üìö", color: "#db3717" },
            { name: "Entretenimiento", icon: "üé≠", color: "#151a2b" },
            { name: "Transporte", icon: "üöó", color: "#db3717" },
            { name: "Belleza", icon: "üíÑ", color: "#151a2b" },
            { name: "Deportes", icon: "‚öΩ", color: "#db3717" },
            { name: "Tecnolog√≠a", icon: "üíª", color: "#151a2b" },
            { name: "Inmobiliaria", icon: "üè†", color: "#db3717" },
            { name: "Automotriz", icon: "üöô", color: "#151a2b" },
            { name: "Mascotas", icon: "üêï", color: "#db3717" }
        ];
        
        // Aplicaci√≥n principal
        class BusinessDirectoryApp {
            constructor() {
                this.storage = new DataLocalStorage();
                this.allBusinesses = [];
                this.filteredBusinesses = [];
                this.activeFilters = {
                    search: '',
                    category: ''
                };
                
                this.init();
            }
            
            init() {
                this.renderCategories();
                this.populateCategorySelect();
                this.setupEventListeners();
                
                // Hacer disponible globalmente para el storage
                window.app = this;
            }
            
            onDataChange(businesses) {
                this.allBusinesses = businesses;
                this.applyFilters();
                this.updateBusinessCount();
            }
            
            renderCategories() {
                const container = document.getElementById('categories-container');
                container.innerHTML = categories.map(category => `
                    <div class="category-card bg-white rounded-xl p-4 text-center shadow-md border-2 border-transparent hover:border-current" 
                         style="color: ${category.color};" 
                         onclick="app.filterByCategory('${category.name}')">
                        <div class="text-3xl mb-2">${category.icon}</div>
                        <h3 class="font-semibold text-sm">${category.name}</h3>
                    </div>
                `).join('');
            }
            
            populateCategorySelect() {
                const select = document.getElementById('business-category');
                select.innerHTML = '<option value="">Seleccionar categor√≠a</option>';
                categories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category.name;
                    option.textContent = `${category.icon} ${category.name}`;
                    select.appendChild(option);
                });
            }
            
            setupEventListeners() {
                // B√∫squeda
                document.getElementById('search-input').addEventListener('input', () => this.handleSearch());
                document.getElementById('search-btn').addEventListener('click', () => this.handleSearch());
                
                // Botones de informaci√≥n
                document.getElementById('about-btn').addEventListener('click', () => this.showAboutModal());
                document.getElementById('services-btn').addEventListener('click', () => this.showServicesModal());
                
                // Modales
                document.getElementById('add-business-btn').addEventListener('click', () => this.openAddModal());
                document.getElementById('empty-add-btn').addEventListener('click', () => this.openAddModal());
                document.getElementById('close-modal').addEventListener('click', () => this.closeAddModal());
                document.getElementById('cancel-btn').addEventListener('click', () => this.closeAddModal());
                document.getElementById('close-info-modal').addEventListener('click', () => this.closeInfoModal());
                
                // Formulario
                document.getElementById('business-form').addEventListener('submit', (e) => this.handleFormSubmit(e));
                
                // Filtros
                document.getElementById('clear-filters').addEventListener('click', () => this.clearAllFilters());
                
                // Cerrar modales al hacer clic fuera
                this.setupModalCloseHandlers();
            }
            
            setupModalCloseHandlers() {
                const modals = ['add-business-modal', 'info-modal'];
                modals.forEach(modalId => {
                    const modal = document.getElementById(modalId);
                    modal.addEventListener('click', (e) => {
                        if (e.target === modal) {
                            modal.classList.add('hidden');
                            modal.classList.remove('flex');
                        }
                    });
                });
            }
            
            handleSearch() {
                this.activeFilters.search = document.getElementById('search-input').value.toLowerCase().trim();
                this.applyFilters();
                this.updateActiveFilters();
            }
            
            filterByCategory(categoryName) {
                this.activeFilters.category = this.activeFilters.category === categoryName ? '' : categoryName;
                this.applyFilters();
                this.updateActiveFilters();
            }
            
            applyFilters() {
                this.filteredBusinesses = this.allBusinesses.filter(business => {
                    const matchesSearch = !this.activeFilters.search || 
                        business.name.toLowerCase().includes(this.activeFilters.search) ||
                        business.description.toLowerCase().includes(this.activeFilters.search) ||
                        business.category.toLowerCase().includes(this.activeFilters.search);
                    
                    const matchesCategory = !this.activeFilters.category || business.category === this.activeFilters.category;
                    
                    return matchesSearch && matchesCategory;
                });
                
                this.renderBusinesses();
            }
            
            updateActiveFilters() {
                const activeFiltersDiv = document.getElementById('active-filters');
                const filterTags = document.getElementById('filter-tags');
                
                const hasFilters = this.activeFilters.search || this.activeFilters.category;
                
                if (hasFilters) {
                    activeFiltersDiv.classList.remove('hidden');
                    let tags = [];
                    
                    if (this.activeFilters.search) {
                        tags.push(`<span class="px-3 py-1 rounded-full text-xs text-white" style="background-color: var(--primary-dark);">üîç "${this.activeFilters.search}"</span>`);
                    }
                    
                    if (this.activeFilters.category) {
                        const category = categories.find(c => c.name === this.activeFilters.category);
                        tags.push(`<span class="px-3 py-1 rounded-full text-xs text-white" style="background-color: var(--primary-orange);">${category.icon} ${category.name}</span>`);
                    }
                    
                    filterTags.innerHTML = tags.join('');
                } else {
                    activeFiltersDiv.classList.add('hidden');
                }
            }
            
            clearAllFilters() {
                this.activeFilters.search = '';
                this.activeFilters.category = '';
                document.getElementById('search-input').value = '';
                this.applyFilters();
                this.updateActiveFilters();
            }
            
            renderBusinesses() {
                const container = document.getElementById('business-list');
                const emptyState = document.getElementById('empty-state');
                const noResults = document.getElementById('no-results');
                
                if (this.allBusinesses.length === 0) {
                    container.innerHTML = '';
                    emptyState.classList.remove('hidden');
                    noResults.classList.add('hidden');
                    return;
                }
                
                if (this.filteredBusinesses.length === 0) {
                    container.innerHTML = '';
                    emptyState.classList.add('hidden');
                    noResults.classList.remove('hidden');
                    return;
                }
                
                emptyState.classList.add('hidden');
                noResults.classList.add('hidden');
                
                container.innerHTML = this.filteredBusinesses.map(business => {
                    const category = categories.find(c => c.name === business.category);
                    const imageUrl = business.image ? `./images/${business.image}` : null;
                    
                    return `
                        <div class="business-card bg-white rounded-xl shadow-md p-6">
                            <div class="flex items-start space-x-4 mb-4">
                                ${imageUrl ? `
                                    <img src="${imageUrl}" alt="${this.escapeHtml(business.name)}" 
                                         class="w-16 h-16 rounded-lg object-cover flex-shrink-0"
                                         onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                    <div class="w-16 h-16 rounded-lg bg-gray-100 flex items-center justify-center text-gray-400 text-2xl flex-shrink-0" style="display: none;">
                                        ${category ? category.icon : 'üè¢'}
                                    </div>
                                ` : `
                                    <div class="w-16 h-16 rounded-lg flex items-center justify-center text-2xl flex-shrink-0" style="background-color: ${category ? category.color : 'var(--primary-orange)'}; color: white;">
                                        ${category ? category.icon : 'üè¢'}
                                    </div>
                                `}
                                
                                <div class="flex-1 min-w-0">
                                    <h3 class="text-lg font-bold truncate" style="color: var(--primary-dark);">
                                        ${this.escapeHtml(business.name)}
                                    </h3>
                                    <div class="flex items-center space-x-2 mt-1">
                                        <span class="px-3 py-1 rounded-full text-xs text-white font-medium" style="background-color: ${category ? category.color : 'var(--primary-orange)'};">
                                            ${category ? category.icon : 'üìã'} ${this.escapeHtml(business.category)}
                                        </span>
                                    </div>
                                </div>
                            </div>
                            
                            ${business.description ? `
                                <p class="text-gray-600 text-sm mb-4">${this.escapeHtml(business.description)}</p>
                            ` : ''}
                            
                            <div class="space-y-2">
                                ${business.phone ? `
                                    <div class="flex items-center space-x-2 text-sm text-gray-600">
                                        <span class="text-lg">üìû</span>
                                        <a href="tel:${business.phone}" class="hover:text-orange-600">${this.escapeHtml(business.phone)}</a>
                                    </div>
                                ` : ''}
                                
                                ${business.address ? `
                                    <div class="flex items-center space-x-2 text-sm text-gray-600">
                                        <span class="text-lg">üìç</span>
                                        <span>${this.escapeHtml(business.address)}</span>
                                    </div>
                                ` : ''}
                                
                                ${business.website ? `
                                    <div class="flex items-center space-x-2 text-sm">
                                        <span class="text-lg">üåê</span>
                                        <a href="${business.website}" target="_blank" rel="noopener noreferrer" 
                                           class="hover:underline" style="color: var(--primary-orange);">
                                            Visitar sitio web
                                        </a>
                                    </div>
                                ` : ''}
                            </div>
                            
                            <div class="flex gap-2 mt-4">
                                ${business.phone ? `
                                    <a href="https://wa.me/${business.phone.replace(/[^0-9]/g, '')}" 
                                       target="_blank" rel="noopener noreferrer"
                                       class="flex-1 bg-green-500 hover:bg-green-600 text-white py-2 px-4 rounded-lg text-center font-medium transition-colors">
                                        üí¨ WhatsApp
                                    </a>
                                ` : ''}
                                <button onclick="app.contactBusiness('${business.id}')" 
                                        class="flex-1 btn-primary py-2 px-4 rounded-lg font-medium">
                                    üìû Contactar
                                </button>
                            </div>
                        </div>
                    `;
                }).join('');
            }
            
            updateBusinessCount() {
                const count = this.allBusinesses.length;
                const countElement = document.getElementById('business-count');
                
                if (count === 0) {
                    countElement.textContent = 'No hay negocios publicados';
                } else if (count === 1) {
                    countElement.textContent = '1 negocio publicado';
                } else {
                    countElement.textContent = `${count} negocios publicados`;
                }
            }
            
            openAddModal() {
                const modal = document.getElementById('add-business-modal');
                modal.classList.remove('hidden');
                modal.classList.add('flex');
                document.getElementById('business-form').reset();
            }
            
            closeAddModal() {
                const modal = document.getElementById('add-business-modal');
                modal.classList.add('hidden');
                modal.classList.remove('flex');
            }
            
            showAboutModal() {
                this.showInfoModal(
                    'üë• Qui√©nes Somos',
                    `<div class="space-y-4">
                        <p>Somos una plataforma dedicada a conectar negocios locales con la comunidad.</p>
                        <p>Nuestro objetivo es:</p>
                        <ul class="list-disc list-inside space-y-2 text-sm">
                            <li>Promover el comercio local</li>
                            <li>Facilitar que las personas descubran servicios</li>
                            <li>Ayudar a los negocios a crecer</li>
                            <li>Fortalecer la econom√≠a de nuestra ciudad</li>
                        </ul>
                    </div>`
                );
            }
            
            showServicesModal() {
                this.showInfoModal(
                    'üõ†Ô∏è Nuestros Servicios',
                    `<div class="space-y-4">
                        <p>Ofrecemos una plataforma completa para que los negocios locales puedan:</p>
                        <ul class="list-disc list-inside space-y-2 text-sm">
                            <li>Publicar informaci√≥n de contacto</li>
                            <li>Mostrar servicios y productos</li>
                            <li>Conectar con clientes potenciales</li>
                            <li>Aumentar visibilidad en la comunidad</li>
                            <li>Gestionar su presencia online</li>
                        </ul>
                        <div class="mt-6 p-4 rounded-lg" style="background-color: #f8f9fa;">
                            <p class="text-sm font-medium">¬øQuieres publicar tu negocio?</p>
                            <p class="text-xs text-gray-600 mt-1">Es gratis y solo toma unos minutos.</p>
                        </div>
                    </div>`
                );
            }
            
            showInfoModal(title, content) {
                document.getElementById('info-modal-title').textContent = title;
                document.getElementById('info-modal-content').innerHTML = content;
                const modal = document.getElementById('info-modal');
                modal.classList.remove('hidden');
                modal.classList.add('flex');
            }
            
            closeInfoModal() {
                const modal = document.getElementById('info-modal');
                modal.classList.add('hidden');
                modal.classList.remove('flex');
            }
            
            async handleFormSubmit(e) {
                e.preventDefault();
                
                const submitBtn = document.getElementById('submit-btn');
                const originalText = submitBtn.textContent;
                submitBtn.innerHTML = '<div class="loading-spinner mx-auto"></div>';
                submitBtn.disabled = true;
                
                const businessData = {
                    name: document.getElementById('business-name').value.trim(),
                    category: document.getElementById('business-category').value,
                    description: document.getElementById('business-description').value.trim(),
                    phone: document.getElementById('business-phone').value.trim(),
                    address: document.getElementById('business-address').value.trim(),
                    website: document.getElementById('business-website').value.trim(),
                    image: document.getElementById('business-image').value.trim()
                };
                
                try {
                    await this.storage.addBusiness(businessData);
                    this.showToast('‚úÖ Negocio publicado exitosamente', 'success');
                    this.closeAddModal();
                } catch (error) {
                    console.error('Error guardando negocio:', error);
                    this.showToast('‚ùå Error al publicar negocio', 'error');
                } finally {
                    submitBtn.textContent = originalText;
                    submitBtn.disabled = false;
                }
            }
            
            contactBusiness(businessId) {
                const business = this.allBusinesses.find(b => b.id === businessId);
                if (business) {
                    this.showToast(`üìû Contactando a ${business.name}...`, 'info');
                    // Aqu√≠ podr√≠as implementar l√≥gica adicional de contacto
                }
            }
            
            showToast(message, type = 'info') {
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                toast.textContent = message;
                
                document.body.appendChild(toast);
                
                setTimeout(() => {
                    toast.classList.add('show');
                }, 100);
                
                setTimeout(() => {
                    toast.classList.remove('show');
                    setTimeout(() => {
                        if (toast.parentNode) {
                            toast.parentNode.removeChild(toast);
                        }
                    }, 300);
                }, 3000);
            }
            
            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        }
        
        // Inicializar aplicaci√≥n cuando el DOM est√© listo
        document.addEventListener('DOMContentLoaded', () => {
            new BusinessDirectoryApp();
        });
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'993261fa75ce67e4',t:'MTc2MTIzNDU0OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>